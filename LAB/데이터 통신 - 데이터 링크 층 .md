데이터 링크 층

        노드 대 노드 통신을 책임.
        데이터 그램을 캡슐화,  역캡슐화
        데이터를 프레임 화

데이터  링크 층 서비스

        프레임 짜기(Framing)
            프레임 : 데이터 링크층에서의 패킷을 부르는 단위
            네트워크 층에서 온 다이어그램을 프레임에서 캡슐화 하여
            프레임 생성

        흐름제어 (Flow Control)
            프레임 생산률이 소비율보다 높으면, 끝단에서 전송 받은 프레임은
            소비될 때까지 버퍼에 저장되어야 한다.
            버퍼가 꽉 차 있다면 1. 프레임 폐기 or 2. 전송을 멈추거나 늦춘다.

        오류제어 (Error Control)
            데이터는 물리층에서 전기적 신호로 변형되어 전송되는데 전송 중
            오류에 취약하게 된다. 그러므로 송신자 노드에서 이를 수정하거나
            재전송을 요구해야 한다.

        혼잡제어 (Congestion Control)
            혼잡 제어 서비스를 제공하나 직접적으로 혼잡 제어를 사용하지 않는다.

데이터  링크 범주

        DLC :  점 대 점 과 브로드캐스트 링크에 연관된 모든 사항을 다룬다.
        MAC : 브로드캐스트와 관련된 특별한 사항을 다룬다.

링크 계층 주소 지정

        데이터그램에서 IP주소는 변경되지 않음.
        프레임 헤더의 링크계층 주소(=MAC 주소)는 링크에서 다른 링크로 이동할때마다 변경.
        각 프레임 헤더는 목적지-발신지 순의 주소를 포함.


1. 유니캐스트 주소

        일-대-일 통신을 의미.  12개의 16진수로 표현
        2번째 수는 짝수이어야만 한다.

2. 멀티캐스트 주소

        일-대-다 통신을 의미.  12개의 16진수로 표현
        2번째 수는 홀수이어야만 한다.

3. 브로드캐스트 주소

        일-대-전체 통신을 의미.  12개의 F로 표현.
        (=48개의 1bit)


논리적 주소(IP Address)를 기반으로 물리적 주소(MAC Address)를 알아오는 프로토콜
<->RARP (Reverse ARP)


오류의 종류

        단일 비트 오류 : 1개의 bit만이 변경되는 오류
        폭주 오류 : 2개 이상의 연속적인 비트들이 변경되는 올

        오류 검출 :  오류가 생겼는지 알아내는 과정
        오류 정정 :  오류의 정확한 내용을 파악하고 수정하는 과정

코딩 : 오류를 방지하기 위하여 여분의 비트를 추가하는 과정
                1. 블록 코딩 ( block coding)
                2. 컨볼 루션 코딩( convolution coding)

블록 코딩 :  메시지를 k비트의 데이터 워드로 나눈 후 r개의 여분 비트를 더하여 n(= k+r)개 비트의 코드워드로 바꾸어 전송

선형 블록 코드(Liner block code)
                두 유효한 코드워드에 대해 xor 연산을 가하면 다른 유효한
                다른 코드워드가 생성되는 코드


해밍 거리 (Hamming distance) :
	두 같은 크기의 워드 사이의 해밍 거리는 서로 차이가 나는 해당 비트들의 개수
	해밍  거리는  두 워드에 XOR 연산을 행하여 결과로 얻은
	값의 1의 개수를 더해 쉽게 구할 수 있다.
	
	ex)
	d(000,011)은 (000 xor o11)=011=2

수신자가 받은 코드워드가 유효하지 않으면 오류 발생으로 인지,
But 손상된 코드가 여전히 유효 코드 워드이면 오류 검출 불가능


최소 해밍 거리 : s개 까지의 오류가 발생해도 오류가 생긴 것을 알아내는 것을
	보장하기 위해서는 볼록 코드의 최소 해밍 거리 d(min)= s+1 이어야 한다.


선형 블록 코드(Liner block code)

                두 유효한 코드워드에 대해 xor 연산을 가하면 다른 유효한
                다른 코드워드가 생성되는 코드


패리티 검사 코드(parity-check code)

                : k비트 데이터 워드를 n=k+1의 코드워드로 바꾸는 것
                추가된 비트를 패리티 비트라고 하며 전체 코드워드의 1의 개수가
                짝수 개가 되도록 한다.
                최소 해밍 거리d(min)=2이며 , 단일비트 오류 검출 코드임의 의미.
                이 방법 역시 선형 블록 코드이다.


순환 중복 검사(CRC, cyclic redundancy check)
		: 부호화기와 복호화기를 통하여  CRC 코드를 만들어 오류 검사
		데이터 워드는 k비트, 코드워드는 n비트
		코드 워드를 n-k+1 사이즈의 수로 나누어 나머지를 
		데이터 워드에 추가

## 검사 합
	
		어떠한 길이의 메시지에도 적용시킬 수 있는 오류 검출 기법
		주로 데이터 링크층 보다는 네트워크 층이나 전송 층에서 사용

		발신지에서, 메시지를 m비트 유닛으로 나눈다. 
		생성기로 m비트 유닛의 보수의 합으로 검사 합을 구하고 메시지와 함께 전송한다.
		목적지는 메시지와 검사 합으로 새로운 검사합을 생성한다. 
		새 검사 합이 0이면 오류가 없다는 뜻이다.


                
# 데이터 링크 층 DLC

 데이터 링크 제어는 두 인접한 노드 사이의 통신을 위한 절차를 다룬다.    	
	프레임 짜기, 흐름 및 오류 제어를 포함


프레임 짜기

                각 프레임이 다른 프레임과 구분되도록 구성.
                송/수신자의 주소를 규정하고 프레임에 포함
                고정 프레임 크기의 프레임과 가변 크기의 프레임으로 
                프레임 생성 방법이 나뉘고 가변 크기의 프레임은
                문자 중심과 비트 중심, 2가지 방법으로 사용된다.

                고정 프레임은  크기 자체가 고정되어 경계의 역할.
                가변 프레임은 시작과 끝을 정의하여 주어야한다.


문자 중심 프레임 짜기(character-oriented framing)

                프레임을 다음 프레임과 분리하기 위하여 8비트 플래그(flag)가 프레임의
                시작점과 마지막에 추가된다. 플래그로 사용되는 패턴이 데이터로
                오인되는 문제를 해결하기 위하여  “바이트 채우기”를 사용한다.
                
                바이트 채우기 : 데이터 내부에 플래그와 동일한 배턴의 데이터가 생기면
                        특별한 바이트( 탈출 문자(ESC,Escape Character)를 추가한다.
                
                
비트 중심 프로토콜

                8비트의 문자 중심 프레임짜기에서 16, 32비트의 유니코드와의 상충을
                해결하기 위하여 최근 쓰이는 방식
                ‘01111110’으로 프레임의 경계를 구분
                데이터를 위 구분 비트로 오인하는 것을 해결하기 위하여
                “비트 채우기” 를 사용한다.
                
                비트 채우기 : 데이터에 0 뒤 연속하는 5개의 1이 있으면 0을 추가한다.

유한상태 머신(FSM, Finite State Machine)

                : 링크층 프로토콜의 동작 상태를 나타낸 것
                상태의 유한 번호를 가진 머신, 머신은 사건이 발생할 때 까지
                항상 여러 상태 중 하나를 가진다.

단순 프로토콜(Simple Protocol)

        	: 수신자는 프레임을 즉시 처리한다.

정지/대기 프로토콜(Stop-and-Wait Protocol)

                : 흐름 및 오류 제어를 사용하는 프로토콜,
                한 번에 하나의 프레임을 보내고 다음 하나를 보내기 전 확인응답을 대기
                
순서 번호(sequence number)

	        : ack에 확인 응답 번호를 추가하여 프레임의 순서를 나타낸다.

피기 배깅 :
        
        	한 방향의 데이터는 다른 방향의 확인 응답에 같이 실어 나르는 것.

하이레벨 데이터 링크 HDLC(High-level Data Link Control) 

                점-대-점과 다중점 링크 위에 통신을 위한 비트 지향 프로토콜
                정지/대기 프로토콜로 구현한다.
                단방향, 반이중, 전이중 통신을 모두 지원하며, 동기식 전송 방식을 사용
                오류 제어를 위해 Go-Back-N ARQ와 선택적 재전송(Selective Repeat) ARQ를 사용
                흐름 제어를 위해 슬라이딩윈도우 사용

        정규 응답 모드 (NRM) : 주국 1개와 여러 개의 종국
        비동기 균형 모드(ABM) : 각 지국이 주국이자 종국

점-대-점 프로토콜 (PPP, Point-to Point Protocol)

                데이터 전송을 제어하고 관리하기 위해서 필요한 프로토콜
                문자 중심 프레임을 사용
                제공하는 서비스
                1. 장치들 사이에서 교환될 프레임의 형식을 제공
                2. 두 장치의 링크 설정을 교섭 및 교환 방법 정의
                But, 오류 제어 제공하지 않는다.


다중화

                PPP 역시 데이터 링크층 프로토콜 이지만 일련의 다른 프로토콜도 사용한다.
                링크 제어 프로토콜(LCP) : 링크의 설정 유지 형성과 해제를 담당.
                네트워크 제어 프로토콜(NCP) : 네트워크층 데이터를 위한 회선을 구성
                인증 프로토콜 (AP) : 사용자의 신원을 인증하기 위한 프로토콜
                        패스워드 인증 프로토콜 PAP
                        챌린지 핸드셰이크 인증 프로토콜 CHAP

# 매체 접근 제어 MAC

## 임의 접근 Random-access

                전송이 지국사이에서 임의로 이루어지며 다음 전송에 대한 규칙이 없다.

ALOHA : 가장 오래된 임의 매체 접근 방식

                순수 알로하 :
                각 지국은 전송할 프레임이 있으면 언제든지 전송
                충돌 발생시 각 지국은 임의 대기 시간을 기다리고 난 후 재 전송
                대기시간 Tb = K * Tp  , (Tp = 최대 전파 소요 시간, K= 실패 횟수 비례 수
                취약 시간 = 2* Tfr ( 프레임 전송시간)
                처리량 S= G * e^(-2G) , G= 생성 되는 프레임 평균 개수, G=1/2일 때 최대
                
                슬롯 알로하 : 
                순수 알로하 보다 취약시간을 줄여 효율성을 높이기 위한 방식
                지국은 매 시간 슬롯이 시작할 때 전송 하도록 규제
                취약 시간 =  Tfr ( 프레임 전송시간)
                처리량 S= G * e^(-G) , G= 생성 되는 프레임 평균 개수, G=1일 때 최대


반송파 감지 다중 접근 CSMA : 충돌을 최소화 하기 위한 기법

		지국이 데이터 전송 전 매체를 감지
		취약 시간 =Tp(전파시간)

                지속방식 : CSMA에서 채널의 상태에 따라 행동을 정의
                1-지속 방식 : 회선이 휴지이면 즉각 프레임 전송. 가장 높은 충돌 위험
                비지속 방식 : 회선이 휴지이면 즉각 전송,
                        휴지가 아닐 시 임의 시간 이후 전송. 충돌과 효율이 동시에 낮아짐
                P지속 방식 : 회선이 휴지 시 정해진 절차에 따라 진행
                        1. 확률 p를 가지고 프레임 전송
                        2. q=1-p 확률로 지국은 다음 슬롯 시작까지 대기 후 회선 감지
                                a. 회선이 휴지 이면 1번으로
                                b. 회선이 사용 중이면 충돌로 간주, 대기 절차 돌입


충돌 검출 매체 감지 다중 접근 CSMA/CD :

                CSMA에 충돌 검출 과정을 추가
                충돌 발생 시 전송을 중단하고 충돌 신호 전송 및
                임의 대기 시간  데이터 재 전송
                최소 프레임 크기 :  전파시간 * 2 * 대역폭
                이더넷 네트워크에서 주 사용

충돌 회피 반송파 감지 다중 접근 CSMA/CA : 

                충돌을 회피, 무선 네트워크를 위해 고안
                프레임 간 공간, 경쟁 구간 및 응답으로 충돌 회피
                
                프레임 간 공간 IFS : 채널이 휴지 이어도 지국은 IFS 시간 후 전송
                경쟁구간 :  시간 슬롯으로 나뉜 일정 시간.  전송 할 지국은 임의 시간 대기,
                        대기 시간이 긴 지국이 우선 순위를 가진다.
                응답 : ack과 타임 아웃을 이용하여 전송 성공 여부 확인

## 제어 접근  Controlled access
	
	전송에 대하여 각 지국들이 상의 하에 전송 권한을 부여한다.


예약 reservation :
	
		각 지국은 데이터 전송 전 시간 슬롯을 예약
		
토큰 통과 token passing :

		각 지국은 논리적 연결을 통해 선-현-후행자로 연결
		토큰이라는 특별 패킷이 지국을 돌며 데이터를 전달.

폴링 polling :
	
		지국 중 하나가 주국, 나머지는 종국이 되는 형태
		주국이 링크를 제어 및 데이터 전달.

		선택 :  주국이 종국의 수신 준비 상태 여부를 확인
		폴 : 주국이 종국들로 부터 전송할 데이터를 수집


# 유선 네트워크


## 이더넷 프로토콜
	
	CSMA/CD 방식을 사용한 LAN 연결 방식
	IEEE 802 프로젝트에 의하여 정의.

표준 이더넷의 특징

		비연결형 서비스 제공 : 연결의 수립과 종료가 없다.
		64~1518 바이트의 프레임 크기 ( 18바이트의 헤더,트레일러 포함)
		CSMA/CD의 전송 방식 이용

주소지정 

		이더넷 네트워크에서 각 지국의 NIC가 가지는 주소
		48비트의 주소로 16진법 표기법을 사용

CSMA/CD 방식의 불 필요

		10Base-T 매체와 스위치의 사용으로 전이중 교환형 이더넷을
		구성하게 되어 CSMA/CD 방법이 불필요 하게 되었다.

이더넷의 향상

		고속 이더넷  : 100Mbps의 전송속도의 이더넷으로 자동협상 기능 추가
		기가 바이트 이더넷 : 전이중 모드를 사용하여 충돌이 없고, 
				광섬유 매체 사용으로 1Gbps의 전송 속도를 지원한다.
		10기가 바이트 이더넷 : 광섬유 매체를 사용하여 10Gbps의 속도를 지원


# 무선 네트워크


## 유무선 비교

		유선 LAN에서는 선을 이용한 매체를 사용하고 무선 LAN에서는 공기를 매체로 이용

		무선은 ad-hoc이라 불리는 유선의 LAN 개념을 사용

		무선은 기반구조 네트워크라는 유선 LAN에서 접속 점 AP를 이용하여 연결
			링크 계층 교환 개념이 존재 하지 않는다.
	
		무선은 감쇠, 간섭,  다중 경로 오류의 특성을 가진다.

## 802.11 프로젝트 WIFI

		802.11 : 무선 이더넷의 표준을 정의한 것으로 무선 이더넷 , WIFI라고도 한다.

		구조 :  
			기본 서비스 세트 BSS 구조 와 BSS의 집합인 확장 서비스 세트 ESS

			AP가 없는 BSS를 ad-hoc 구조, 있는 bss를 기반 구조 bss라고 한다.



## 숨겨진 지국 문제

![image](https://user-images.githubusercontent.com/43804441/50898888-d9c63f00-1453-11e9-871f-da0ce72c29ae.png)

	 - B지국은 C지국에 의해 전송되는 신호감지 X.
	- C지국도 B지국에 의해 전송되는 신호감지 X.
	- A의 관점에서 B와 C는 숨겨져 있다고 한다.

![image](https://user-images.githubusercontent.com/43804441/50898993-227df800-1454-11e9-816f-956c31ead149.png)

	핸드셰이크 프레임 RTS와 CTS를 사용하여 문제 해결

## 노출된 지국 문제
	
	
![image](https://user-images.githubusercontent.com/43804441/50899018-388bb880-1454-11e9-96ae-f6a7524173b3.png)
	
	- 노출된 지국 문제가 있을때, 지국은 채널 사용을 멈춘다.
	  - A가 B로 데이터를 전송하는 중이다.
	  - C가 A에서 B로의 데이터 전송을 어떤 간섭도 받지 않는 D에 전송하기 위한 어떤 데이터를 가지고 있다.
	  - 그러나 C는 A로부터의 데이터 전송에 노출되어 있다.
	  - 그러므로 같은 채널에 있는 C는 A가 B로 전송하는 것을 감지하고, C의 D로의 데이터 전송을 멈춘다.
	  - 다시말해, C는 채널의 용량을 낭비한다.
![image](https://user-images.githubusercontent.com/43804441/50899163-afc14c80-1454-11e9-9694-efc23dc5539b.png)


## 블루투스 

		서로 다른 기능을 가진 장치의 연결을 위한 무선 LAN 기술
		애드 혹 네트워크라고 하며 피코넷이라는 네트워크 형성
		IEEE 802.15에 의한 표준 정의

	피코넷 :  8개까지의 지국을 가질 수 있는 네트워크, 한 개의 지국과 7개까지의 종국
		7개 이상의 종국이 있을 수 있지만 7개 까지만 동작
	스캐터넷 :  피코넷의 한 종국이 다른 피코넷의 주국이 되어 있는 형태


	링크 : 주국과 종국 사이에는 SCO링크와 ACL링크, 2가지 종류의 링크 가능

		SCO 동기 연결 지향 : 지연 회피가 무결성보다 중요, 재전송 X
		ACL 비동기 연결 지향 : 무결성이 지연 회피 보다 중요, 재전송 O
		
	블루투스는 TDD-TDMA 방식을 사용하여 반이중 양방향 통신
	단일 종국 통신과 다중 종국 통신
	
	
	대역과 간섭 회피 

		블루투스는 2.4GHz의 ISM 대역 사용. 한 채널당 1MHz씩 79개 채널
		FHSS로 타 네트워크로 부터의 간섭을 회피

